# 🛡️ HNUST 成绩自动监控哨兵 (V16.0 失眠版)

> **专为湖南科技大学教务系统打造的成绩实时监控工具**
> *采用 Web Worker 多线程技术，突破浏览器后台休眠限制，静默监控，出分即报。*

### 📖 简介

这是一个 **Tampermonkey (油猴)** 脚本。它解决了学校教务系统成绩查询页面“伪静态”无法自动刷新、Iframe 框架嵌套无法读取数据、以及浏览器后台休眠导致脚本失效等一系列技术难题。

### ✨ 核心功能 (V16.0)

1. **☕ Web Worker 独立心跳：**
* 将计时逻辑剥离到后台独立线程（Worker）运行，不再依赖主页面的渲染线程。
* **效果：** 即使浏览器最小化，后台线程依然能保持秒级计时，极大降低被浏览器“冻结”的概率。


2. **🧬 DNA 精准定位：**
* 通过识别按钮的 `onclick="queryKscj()"` 属性定位查询键。
* **效果：** 彻底解决了误触“PDF导出”按钮的问题。


3. **🚓 跨楼层执法 (Cross-Frame)：**
* 脚本运行在主框架，但能自动穿透到 `cjcx_list_frm` 子框架中读取数据。
* **效果：** 完美解决“查询成功但读不到表格数据”的问题。


4. **📝 实名制报喜：**
* 不数行数，只记课名。直接弹窗告诉你 **“新增了哪一门课”**（如：*出分啦！新增：马克思主义基本原理*）。



---

### 🛠️ 安装指南

1. **准备环境：**
* 浏览器：推荐 **Microsoft Edge** 或 **Google Chrome**。
* 插件：安装 **Tampermonkey (油猴)** 扩展。


2. **安装脚本：**
* 点击油猴图标 -> **添加新脚本**。
* 删除编辑器内所有默认代码。
* 将 **V16.0** 版本的完整代码粘贴进去。
* 按下 `Ctrl + S` 保存。



---

### 🎮 使用说明

1. **登录系统：** 进入湖南科技大学教务系统。
2. **进入页面：** 点击左侧菜单 **【我的成绩】** -> **【课程成绩查询】**。
3. **设置条件：** 在顶部的下拉菜单中选好你要查的学期（如 `2025-2026-1`）。
4. **启动监控：**
* 看页面 **左下角**，会出现一个黑色的状态栏。
* 点击红色的 **【▶ 启动强力监控】** 按钮。
* *注：此版本不会播放任何声音，标签页上也不会有小喇叭。*



---

### ⚙️ 浏览器设置 (至关重要！)

**因为 V16.0 没有使用音频防休眠，为了确保 100% 不断连，请务必执行以下操作：**

**对于 Edge 浏览器：**

1. 打开浏览器 **设置** (`edge://settings/system`)。
2. 进入 **系统和性能**。
3. 找到 **“优化性能”** 区域：
* **关闭** “使用效率模式”。
* 或者保持开启，但在 **“从不让这些网站进入睡眠状态”** 中点击【添加】，输入：`kdjw.hnust.edu.cn`。



**对于 Chrome 浏览器：**

1. 打开 **设置** -> **性能** (`chrome://settings/performance`)。
2. 在 **“始终保持活动状态的网站”** 中点击【添加】，输入：`kdjw.hnust.edu.cn`。

---

### 🚨 常见问题 (Q&A)

**Q: 为什么最小化很久之后，倒计时好像变慢了？**
A: 如果没有设置上面的浏览器白名单，浏览器可能会强行降低后台线程的优先级。请务必把教务系统加入“从不睡眠”名单。

**Q: 为什么左下角一直显示“⏳ 等待数据”？**
A: 可能是学校服务器卡顿。脚本会每秒检查一次，最多等待 20 秒。如果一直出不来，脚本会在下次循环时重试。

**Q: 如何停止监控？**
A: 直接刷新网页或关闭标签页即可。

---

### ⚠️ 免责声明

* 本脚本仅供技术学习与交流使用，请勿用于任何非法用途。
* 脚本本质是模拟人工点击，**不涉及** 入侵服务器或通过非公开接口抓取数据。
* 请合理设置刷新频率（默认 5 分钟），避免给学校服务器造成过大压力。

---

**Code by Castian & Caleb (The Cloud Brother)**
*Last Updated: Jan 2026*
