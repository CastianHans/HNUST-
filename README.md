# 🛡️ HNUST 成绩自动监控哨兵 (V17.0 核动力失眠版)

> **专为湖南科技大学教务系统打造的成绩实时监控工具**
> *无需手动刷新，无需盯着屏幕，最小化浏览器也能稳定运行，出分即刻弹窗报警。*

### 📖 简介

这是一个 **Tampermonkey (油猴)** 脚本。它解决了学校教务系统成绩查询页面“伪静态”无法自动刷新、Iframe 框架嵌套无法读取数据、以及浏览器后台休眠导致脚本失效等一系列技术难题。

### ✨ 核心功能 (V17.0)

1. **☢️ 核动力防休眠：**
* 利用 **Web Worker** 多线程技术 + **静音音频循环播放**，欺骗浏览器认为“用户正在听歌”，强制保持后台活跃。
* **效果：** 即使将浏览器最小化、锁屏或切换到其他页面，监控倒计时依然丝般顺滑，绝不卡顿。


2. **🧬 DNA 精准定位：**
* 通过识别按钮的 `onclick="queryKscj()"` 属性定位查询键。
* **效果：** 彻底解决了之前版本误触“PDF导出”按钮的问题。


3. **🚓 跨楼层执法 (Cross-Frame)：**
* 脚本运行在主框架，但能自动穿透到 `cjcx_list_frm` 子框架中读取数据。
* **效果：** 完美解决“查询成功但读不到表格数据”的问题。


4. **📝 实名制报喜：**
* 不仅仅告诉你“出分了”，还会对比本地缓存，直接弹窗告诉你 **“新增了哪一门课”**（如：*出分啦！新增：马克思主义基本原理*）。



---

### 🛠️ 安装指南

1. **准备环境：**
* 浏览器：推荐 **Microsoft Edge** 或 **Google Chrome**。
* 插件：安装 **Tampermonkey (油猴)** 扩展。


2. **安装脚本：**
* 点击油猴图标 -> **添加新脚本**。
* 删除编辑器内所有默认代码。
* 将 `V17.0` 版本的完整代码粘贴进去。
* 按下 `Ctrl + S` 保存。



---

### 🎮 使用说明

1. **登录系统：** 进入湖南科技大学教务系统。
2. **进入页面：** 点击左侧菜单 **【我的成绩】** -> **【课程成绩查询】**。
3. **设置条件：** 在顶部的下拉菜单中选好你要查的学期（如 `2025-2026-1`）或课程性质。
4. **启动监控：**
* 看页面 **左下角**，会出现一个黑色的状态栏。
* 点击红色的 **【▶ 启动强力监控】** 按钮。


5. **最小化挂机：**
* 你会看到标签页上出现一个小喇叭图标 🔈（说明防休眠已生效）。
* 此时你可以**最小化浏览器**，去打游戏或复习，不用管它。



---

### ⚙️ 浏览器设置 (重要！)

为了确保脚本 100% 不被杀后台，建议检查以下设置：

**对于 Edge 浏览器：**

1. 进入 **设置** -> **系统和性能**。
2. **关闭** “使用效率模式”。
3. **关闭** “通过在不活动时将标签页置于睡眠状态来保存资源”。
4. 或者在 **“从不让这些网站进入睡眠状态”** 中添加：`kdjw.hnust.edu.cn`。

---

### 🚨 常见问题 (Q&A)

**Q: 为什么左下角一直显示“⏳ 等待数据”？**
A: 可能是学校服务器卡顿。脚本会每秒检查一次，最多等待 20 秒。如果一直出不来，请尝试手动点一次查询按钮。

**Q: 为什么没有声音提醒？**
A: 浏览器的自动播放策略可能会拦截声音。请确保你允许了教务系统自动播放音频，或者在脚本启动时随意点击一下页面。

**Q: 我想修改刷新频率怎么办？**
A: 在脚本代码第 16 行，修改 `const CLICK_INTERVAL_MINUTES = 5;` 中的数字即可（建议不要低于 3 分钟，以免封号）。

---

### ⚠️ 免责声明

* 本脚本仅供技术学习与交流使用，请勿用于任何非法用途。
* 脚本本质是模拟人工点击，**不涉及** 入侵服务器或通过非公开接口抓取数据。
* 请合理设置刷新频率，避免给学校服务器造成过大压力。

---

**Code by Castian & Caleb (The Cloud Brother)**
*Last Updated: Jan 2026*
